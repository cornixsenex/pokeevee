
//FLAG_TEMP_7 is set after slowking advice (Only one advice per entrance)

mapscripts AedesTrivis_MapScripts {

	MAP_SCRIPT_ON_TRANSITION {
		//Setup OrestesSageScene
		if (var(VAR_ORESTES_STATE) == 2) {
			call (AedesTrivis_Script_ShowOrestesSageScene)
		}
		//During Triforce Quest
		if (var(VAR_ORESTES_STATE) == 3) {
			call (AedesTrivis_Script_ShowDuringTrivisQuest)
			call (AedesTrivis_Script_CheckTrivisComplete)
		}
		//Return to Aedes Trivis from whiteout after Trivis Complete 
		if (var(VAR_ORESTES_STATE) == 5) {
			call (AedesTrivis_Script_SetupReturnFromWhiteout)
		}
		//After Orestes has left - slowking on stage, sage attending - terminal state?
		if (var(VAR_ORESTES_STATE) > 5) {
			call (AedesTrivis_Script_SetupSlowkingEtSage)
		}
		
	}


	MAP_SCRIPT_ON_LOAD { // After Trivis Complete Scene
		//Hide Triforce on floor
		if (var(VAR_ORESTES_STATE) < 5) {
			call (AedesTrivis_Script_HideTriforceFloor)
		}

	}

	MAP_SCRIPT_ON_WARP_INTO_MAP_TABLE [
		VAR_ORESTES_STATE, 5: AedesTrivis_Script_FacePlayerUp
	]

	MAP_SCRIPT_ON_FRAME_TABLE [
		VAR_ORESTES_STATE, 2: AedesTrivis_Script_OrestesSageScene
		VAR_ORESTES_STATE, 4: AedesTrivis_Script_TrivisCompleteScene1
		VAR_ORESTES_STATE, 5: AedesTrivis_Script_TrivisCompleteScene2
	]

}

script AedesTrivis_Script_ShowOrestesSageScene {
	setobjectxyperm (LOCALID_AEDESTRIVIS_SAGE, 11, 8)
	setobjectmovementtype (LOCALID_AEDESTRIVIS_SAGE, MOVEMENT_TYPE_FACE_DOWN)
	setobjectxyperm (LOCALID_AEDESTRIVIS_ORESTES, 11, 10)
	setobjectmovementtype (LOCALID_AEDESTRIVIS_ORESTES, MOVEMENT_TYPE_FACE_UP)
	return
}

script AedesTrivis_Script_ShowDuringTrivisQuest {
	setobjectxyperm (LOCALID_AEDESTRIVIS_SAGE, 11, 8)
	setobjectmovementtype (LOCALID_AEDESTRIVIS_SAGE, MOVEMENT_TYPE_FACE_DOWN)
	setobjectxyperm (LOCALID_AEDESTRIVIS_ORESTES, 11, 9)
	setobjectmovementtype (LOCALID_AEDESTRIVIS_ORESTES, MOVEMENT_TYPE_FACE_DOWN)
	return

}

script AedesTrivis_Script_HideTriforceFloor {
	//Row 1
	setmetatile (11,  5, METATILE_PetalburgGym_TempleFloor, FALSE)
	//Row 2
	setmetatile (10,  6, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (11,  6, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (12,  6, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	//Row 3
	setmetatile ( 9,  7, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (10,  7, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (11,  7, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (12,  7, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (13,  7, METATILE_PetalburgGym_TempleFloor, FALSE)
	//Row 4
	setmetatile ( 8,  8, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 9,  8, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (10,  8, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (11,  8, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (12,  8, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (13,  8, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (14,  8, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	//Row 5
	setmetatile ( 7,  9, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile ( 8,  9, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile ( 9,  9, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (10,  9, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (11,  9, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (12,  9, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (13,  9, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (14,  9, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (15,  9, METATILE_PetalburgGym_TempleFloor, FALSE)
	//Row 6
	setmetatile ( 6, 10, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 7, 10, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 8, 10, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 9, 10, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (10, 10, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (11, 10, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (12, 10, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (13, 10, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (14, 10, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (15, 10, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (16, 10, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	//Row 7
	setmetatile ( 5, 11, METATILE_PetalburgGym_TempleFloor, FALSE)

	setmetatile (17, 11, METATILE_PetalburgGym_TempleFloor, FALSE)
	//Row 8
	setmetatile ( 4, 12, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 5, 12, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 6, 12, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)

	setmetatile (16, 12, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (17, 12, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (18, 12, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	//Row 9
	setmetatile ( 3, 13, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile ( 4, 13, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile ( 5, 13, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile ( 6, 13, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile ( 7, 13, METATILE_PetalburgGym_TempleFloor, FALSE)

	setmetatile (15, 13, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (16, 13, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (17, 13, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (18, 13, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (19, 13, METATILE_PetalburgGym_TempleFloor, FALSE)
	//Row 10
	setmetatile ( 2, 14, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 3, 14, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 4, 14, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 5, 14, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 6, 14, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 7, 14, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 8, 14, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)

	setmetatile (14, 14, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (15, 14, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (16, 14, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (17, 14, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (18, 14, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (19, 14, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (20, 14, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	//Row 11
	setmetatile ( 1, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile ( 2, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile ( 3, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile ( 4, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile ( 5, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile ( 6, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile ( 7, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile ( 8, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile ( 9, 15, METATILE_PetalburgGym_TempleFloor, FALSE)

	setmetatile (13, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (14, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (15, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (16, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (17, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (18, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (19, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (20, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	setmetatile (21, 15, METATILE_PetalburgGym_TempleFloor, FALSE)
	//Row 12
	setmetatile ( 0, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 1, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 2, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 3, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 4, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 5, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 6, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 7, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 8, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile ( 9, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (10, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)

	setmetatile (12, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (13, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (14, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (15, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (16, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (17, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (18, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (19, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (20, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (21, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	setmetatile (22, 16, METATILE_PetalburgGym_TempleFloor_Shadow, FALSE)
	//fin
	return
}

script AedesTrivis_Script_CheckTrivisComplete {
	checkitem (ITEM_TRIVIS_FORTITUDINIS)
    if (var(VAR_RESULT) == YES) {
        checkitem (ITEM_TRIVIS_SAPIENTIAE)
        if (var(VAR_RESULT) == YES) {
            checkitem (ITEM_TRIVIS_POTESTATIS)
            if (var(VAR_RESULT) == YES) {
                call (AedesTrivis_Script_SetupTrivisComplete)
            }
        }
    }
    return
}

script AedesTrivis_Script_SetupTrivisComplete {
    //setup objects
	setobjectxyperm (LOCALID_AEDESTRIVIS_SAGE, 10, 10)
	setobjectmovementtype (LOCALID_AEDESTRIVIS_SAGE, MOVEMENT_TYPE_FACE_RIGHT)
	setobjectxyperm (LOCALID_AEDESTRIVIS_ORESTES, 12, 10)
	setobjectmovementtype (LOCALID_AEDESTRIVIS_ORESTES, MOVEMENT_TYPE_FACE_LEFT)
    //set var to trigger On Frame scene
    setvar (VAR_ORESTES_STATE, 4)
	return
}

script AedesTrivis_Script_SetupReturnFromWhiteout {
    //setup objects
	setobjectxyperm (LOCALID_AEDESTRIVIS_SAGE, 10, 11)
	setobjectmovementtype (LOCALID_AEDESTRIVIS_SAGE, MOVEMENT_TYPE_FACE_DOWN)
	setobjectxyperm (LOCALID_AEDESTRIVIS_ORESTES, 12, 11)
	setobjectmovementtype (LOCALID_AEDESTRIVIS_ORESTES, MOVEMENT_TYPE_FACE_DOWN)
	return
}

script AedesTrivis_Script_FacePlayerUp {
	turnobject (LOCALID_PLAYER, DIR_NORTH)
	return
}

script AedesTrivis_Script_SetupSlowkingEtSage {
	//setup objects
	setobjectxyperm (LOCALID_AEDESTRIVIS_SAGE, 10, 4)
	setobjectmovementtype (LOCALID_AEDESTRIVIS_SAGE, MOVEMENT_TYPE_FACE_DOWN)
	setobjectxyperm (LOCALID_AEDESTRIVIS_SLOWKING, 11, 2)
	setobjectmovementtype (LOCALID_AEDESTRIVIS_SLOWKING, MOVEMENT_TYPE_FACE_DOWN)

}

script AedesTrivis_Script_Orestes {
	//Only possible to talk to him here during Trivis Quest
    load_field_pic (FIELD_PIC_ORESTES, 190, 98)
	msgbox (AedesTrivis_Text_OrestesDuringTrivisQuest, MSGBOX_NPC)
	destroy_field_pic (FIELD_PIC_ORESTES)
}

script AedesTrivis_Script_Sage {
	//During Quest:
	if (var(VAR_ORESTES_STATE) < 69) {
		//Trivis Quest Intro
		load_field_pic (FIELD_PIC_SAGE, 190, 98)
		if (!flag(FLAG_AEDES_TRIVIS_SAGEINTROD)) {
			setflag (FLAG_AEDES_TRIVIS_SAGEINTROD)
			msgbox (AedesTrivis_Text_SageIntroQuest)
		//After intro
		} else {
			msgbox (AedesTrivis_Text_SageDuringQuest)
		}
		//else fin
		closemessage
		destroy_field_pic (FIELD_PIC_SAGE)
		end
	}
	//After Quest(?)
}

script AedesTrivis_Script_Slowking {
	//Come again ie divination DONE / One per map transition
	if (flag(FLAG_TEMP_7)) {
		load_field_pic (FIELD_PIC_SLOWKING, 190, 98)
		msgbox (AedesTrivis_Text_Slowking_Return)
		destroy_field_pic (FIELD_PIC_SLOWKING)
		closemessage
		end
	//Divination
	} else {
	}
}

script AedesTrivis_Script_OrestesSageScene {
	lockall
	//setvar
	setvar (VAR_ORESTES_STATE, 3)
	//Alert Player
	applymovement (LOCALID_PLAYER, Common_Movement_ExclamationMark)
	waitmovement (0)
	//plaer approach
	applymovement (LOCALID_PLAYER, Common_Movement_WalkUp6)
	waitmovement (0)
	//W: What do you mean he's not here
    load_field_pic (FIELD_PIC_ORESTES, 190, 98)
	msgbox (AedesTrivis_Text_OrestesSageScene_Orestes1)
	destroy_field_pic (FIELD_PIC_ORESTES)
	//S: As I said the speaker's podium is vacant. He has been gone ever since the pirate in green stole the Trivis
	load_field_pic (FIELD_PIC_SAGE, 190, 98)
	msgbox (AedesTrivis_Text_OrestesSageScene_Sage1)
	destroy_field_pic (FIELD_PIC_SAGE)
	//W: Well who are you? Why can't you go get it
    load_field_pic (FIELD_PIC_ORESTES, 190, 98)
	msgbox (AedesTrivis_Text_OrestesSageScene_Orestes2)
	destroy_field_pic (FIELD_PIC_ORESTES)
	//S: I am the stweard of the temple and I'm bound to it by oath. You, or a champion better than you, may go out and seek the Trivis. If it is restored then the speaker may return but until then I can offer no spiritual guidance
	load_field_pic (FIELD_PIC_SAGE, 190, 98)
	msgbox (AedesTrivis_Text_OrestesSageScene_Sage2)
	destroy_field_pic (FIELD_PIC_SAGE)
	//Turn Wally down
    load_field_pic (FIELD_PIC_ORESTES, 190, 98)
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_FaceDown)
	waitmovement (0)
	//W: Despair! God has forsaken me!
	msgbox (AedesTrivis_Text_OrestesSageScene_Orestes3)
	destroy_field_pic (FIELD_PIC_ORESTES)
	closemessage
	//Wally to player
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_WalkDown)
	waitmovement (0)
	//Alert Wally
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_ExclamationMark)
	waitmovement (0)
	//W: Who are you? The odds of another traveller coming here at the same time as me are impossible you must have been sent to help me out! I am most distressted and must speak with the oracle and know which path to follow but that guy says the oracle is gone and won't return until some Tree Vist is brought back. Go ask him what he's talking about and help me out, please! I'm going to die if I can't speak with the oracle
    load_field_pic (FIELD_PIC_ORESTES, 190, 98)
	msgbox (AedesTrivis_Text_OrestesSageScene_Orestes4)
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_ExclamationMark)
	waitmovement (0)
	msgbox (AedesTrivis_Text_OrestesSageScene_Orestes5)
	destroy_field_pic (FIELD_PIC_ORESTES)
	closemessage
	//fin
	releaseall
	end
}

script AedesTrivis_Script_TrivisCompleteScene1 {
	lockall
    //Alert player
	applymovement (LOCALID_PLAYER, Common_Movement_ExclamationMark)
	waitmovement (0)
    //Player approach
	applymovement (LOCALID_PLAYER, Common_Movement_WalkUp6)
	waitmovement (0)
    //The two of them arguing
	//O: I told you I'm cursed I need to know what to do because as we wait my father is dishonored but it's my mother doing the defiling! I must know whether to act the anguish will lead me to death
    load_field_pic (FIELD_PIC_ORESTES, 190, 98)
	msgbox (AedesTrivis_Text_Orestes_TrivisComplete1)
	destroy_field_pic (FIELD_PIC_ORESTES)
	//S: And I told you I am a mere custodian of this place. The speaker has gone and only the Trivis Returned could possibly bring him back
    load_field_pic (FIELD_PIC_SAGE, 190, 98)
	msgbox (AedesTrivis_Text_Sage_TrivisComplete1)
	destroy_field_pic (FIELD_PIC_SAGE)
    //alert both
	applymovement (LOCALID_AEDESTRIVIS_SAGE, Common_Movement_ExclamationMark)
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_ExclamationMark)
	waitmovement (0)
	//turn both
	applymovement (LOCALID_AEDESTRIVIS_SAGE, Common_Movement_FaceDown)
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_FaceDown)
	waitmovement (0)
	//O: Player, you're back
    load_field_pic (FIELD_PIC_ORESTES, 190, 98)
	msgbox (AedesTrivis_Text_Orestes_TrivisComplete2)
	destroy_field_pic (FIELD_PIC_ORESTES)
	//S: Have you returned with what you seeked?
    load_field_pic (FIELD_PIC_SAGE, 190, 98)
	msgbox (AedesTrivis_Text_Sage_TrivisComplete2)
	destroy_field_pic (FIELD_PIC_SAGE)
	closemessage
	//Both approach
	applymovement (LOCALID_AEDESTRIVIS_SAGE, Common_Movement_WalkDown)
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_WalkDown)
	waitmovement (0)
	//alert all
	applymovement (LOCALID_AEDESTRIVIS_SAGE, Common_Movement_ExclamationMark)
	applymovement (LOCALID_PLAYER, Common_Movement_ExclamationMark)
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_ExclamationMark)
	waitmovement (0)
	//Trivis begins to glow message
    playse (SE_M_HYPER_BEAM)
    waitse
	msgbox (AedesTrivis_Text_TrivisGlow)
    playse (SE_M_HYPER_BEAM)
    waitse
	//white out
    fadescreenswapbuffers (FADE_TO_WHITE)
    delay (40)
	//remove items
	removeitem (ITEM_TRIVIS_FORTITUDINIS)
	removeitem (ITEM_TRIVIS_SAPIENTIAE)
	removeitem (ITEM_TRIVIS_POTESTATIS)
    //set var for trivis floor
	setvar (VAR_ORESTES_STATE, 5)
	//warp back to map (show Trivis and trigger rest of scene OnFrame5)
	warpsilent (MAP_AEDES_TRIVIS, 11, 12)
}


//load back in with trivis floor visible
script AedesTrivis_Script_TrivisCompleteScene2 {
	lockall
	//O: What just happened. What was that light?
    load_field_pic (FIELD_PIC_ORESTES, 190, 98)
	msgbox (AedesTrivis_Text_Orestes_TrivisComplete3)
	destroy_field_pic (FIELD_PIC_ORESTES)
	//S: You've done it, you've returned the Trivis!
    //S: It's finnaly happened our temple has been restored
    load_field_pic (FIELD_PIC_SAGE, 190, 98)
	msgbox (AedesTrivis_Text_Sage_TrivisComplete3)
	destroy_field_pic (FIELD_PIC_SAGE)
	//O: The tree vest? That means...
    load_field_pic (FIELD_PIC_ORESTES, 190, 98)
	msgbox (AedesTrivis_Text_Orestes_TrivisComplete4)
	destroy_field_pic (FIELD_PIC_ORESTES)
    //SK offscreen - Thank you {PLAYER}
    load_field_pic (FIELD_PIC_SLOWKING, 190, 98)
	msgbox (AedesTrivis_Text_Slowking_TrivisComplete1)
	destroy_field_pic (FIELD_PIC_SLOWKING)
    //alert all
	applymovement (LOCALID_AEDESTRIVIS_SAGE, Common_Movement_ExclamationMark)
	applymovement (LOCALID_PLAYER, Common_Movement_ExclamationMark)
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_ExclamationMark)
	waitmovement (0)
	//O: Who was that?
    load_field_pic (FIELD_PIC_ORESTES, 190, 98)
	msgbox (AedesTrivis_Text_Orestes_TrivisComplete5)
	destroy_field_pic (FIELD_PIC_ORESTES)
	//turn all
	applymovement (LOCALID_AEDESTRIVIS_SAGE, Common_Movement_FaceUp)
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_FaceUp)
	waitmovement (0)
    //S: The speaker has returned!
    load_field_pic (FIELD_PIC_SAGE, 190, 98)
	msgbox (AedesTrivis_Text_Sage_TrivisComplete4)
	destroy_field_pic (FIELD_PIC_SAGE)
	closemessage
	//Put slowking into position
	removeobject (LOCALID_AEDESTRIVIS_SLOWKING)
	setobjectxyperm (LOCALID_AEDESTRIVIS_SLOWKING, 11, 2)
	setobjectmovementtype (LOCALID_AEDESTRIVIS_SLOWKING, MOVEMENT_TYPE_FACE_DOWN)
	addobject (LOCALID_AEDESTRIVIS_SLOWKING)
    //S, Player, et Orestes to SK 
	applymovement (LOCALID_AEDESTRIVIS_SAGE, Common_Movement_WalkUp6)
	applymovement (LOCALID_PLAYER, Common_Movement_WalkUp6)
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_WalkUp6)
	waitmovement (0)
	applymovement (LOCALID_PLAYER, Common_Movement_WalkUp)
	waitmovement (0)
	applymovement (LOCALID_AEDESTRIVIS_SAGE, Common_Movement_WalkUp)
	waitmovement (0)
	applymovement (LOCALID_AEDESTRIVIS_SAGE, Common_Movement_FaceDown)
	waitmovement (0)
    //SK: Correct now that PLAYER has brought back the Trivis I have returned
    load_field_pic (FIELD_PIC_SLOWKING, 190, 98)
	msgbox (AedesTrivis_Text_Slowking_TrivisComplete2)
	destroy_field_pic (FIELD_PIC_SLOWKING)
	//S:Mighty speaker...
    load_field_pic (FIELD_PIC_SAGE, 190, 98)
	msgbox (AedesTrivis_Text_Sage_TrivisComplete4)
	destroy_field_pic (FIELD_PIC_SAGE)
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_ExclamationMark)
	waitmovement (0)
	//O: Hello!
    load_field_pic (FIELD_PIC_ORESTES, 190, 98)
	msgbox (AedesTrivis_Text_Orestes_TrivisComplete6)
	destroy_field_pic (FIELD_PIC_ORESTES)
	closemessage
	//Orestes to the dias
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_WalkUp)
	waitmovement (0)
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_WalkLeft)
	waitmovement (0)
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_WalkUp)
	waitmovement (0)
	//O: Intro
    load_field_pic (FIELD_PIC_ORESTES, 190, 98)
	msgbox (AedesTrivis_Text_Orestes_TrivisComplete7)
	destroy_field_pic (FIELD_PIC_ORESTES)
	//SK: Hasty!
    load_field_pic (FIELD_PIC_SLOWKING, 190, 98)
	msgbox (AedesTrivis_Text_Slowking_TrivisComplete3)
	destroy_field_pic (FIELD_PIC_SLOWKING)
	//O: monologue
    load_field_pic (FIELD_PIC_ORESTES, 190, 98)
	msgbox (AedesTrivis_Text_Orestes_TrivisComplete8)
	destroy_field_pic (FIELD_PIC_ORESTES)
	//SK: Advice
	load_field_pic (FIELD_PIC_SLOWKING, 190, 98)
	msgbox (AedesTrivis_Text_Slowking_TrivisComplete4)
	destroy_field_pic (FIELD_PIC_SLOWKING)
	//O: But
    load_field_pic (FIELD_PIC_ORESTES, 190, 98)
	msgbox (AedesTrivis_Text_Orestes_TrivisComplete9)
	destroy_field_pic (FIELD_PIC_ORESTES)
	//SK: I have spoken. Be gone.
	load_field_pic (FIELD_PIC_SLOWKING, 190, 98)
	msgbox (AedesTrivis_Text_Slowking_TrivisComplete5)
	destroy_field_pic (FIELD_PIC_SLOWKING)
	closemessage
	//Exit Orestes (DO rest his stuff outside the temple on frame)
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_WalkDown)
	waitmovement (0)
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_WalkRight)
	waitmovement (0)
	applymovement (LOCALID_AEDESTRIVIS_ORESTES, Common_Movement_WalkDown6)
	waitmovement (0)
	//remove Orestes
	removeobject (LOCALID_AEDESTRIVIS_ORESTES)
	setobjectxyperm (LOCALID_AEDESTRIVIS_ORESTES, 0, 0)
	setobjectmovementtype (LOCALID_AEDESTRIVIS_ORESTES, MOVEMENT_TYPE_INVISIBLE)
	addobject (LOCALID_AEDESTRIVIS_ORESTES)
	//SK: Now approach Sneed I wish to thank you for your service to the temple
	load_field_pic (FIELD_PIC_SLOWKING, 190, 98)
	msgbox (AedesTrivis_Text_Slowking_TrivisComplete6)
	destroy_field_pic (FIELD_PIC_SLOWKING)
	closemessage
	//Player to SK
	applymovement (LOCALID_PLAYER, Common_Movement_WalkUp2)
	waitmovement (0)
	//SK: You have done a great deed and restored a place of light in this world of darkness As thanks I present to you this gift
	load_field_pic (FIELD_PIC_SLOWKING, 190, 98)
	msgbox (AedesTrivis_Text_Slowking_TrivisComplete7)
	destroy_field_pic (FIELD_PIC_SLOWKING)
	//give item Kings_Rock
	giveitem (ITEM_KINGS_ROCK)
	//That rock was once the crown upon the head of a mighty king. Use it well. and if the path forward seems dim return to me and I will shed light on it for you
	load_field_pic (FIELD_PIC_SLOWKING, 190, 98)
	msgbox (AedesTrivis_Text_Slowking_TrivisComplete8)
	msgbox (AedesTrivis_Text_Slowking_Return)
	destroy_field_pic (FIELD_PIC_SLOWKING)
	closemessage
    //NOTE: SK should only read futures on a re-entry not this initial episode
	setflag (FLAG_TEMP_7)
    //set vars
    setvar (VAR_ORESTES_STATE, 6)
    //fin
	releaseall
	end
}

text AedesTrivis_Text_OrestesSageScene_Orestes1 {
	format("What do you mean 'The Speaker is not here?'
			I must consult the oracle!")
}

text AedesTrivis_Text_OrestesSageScene_Sage1 {
	format("He's gone.
			I already told you ever since the
			green robed pirate carried off the Trivis
			the speaker's pedestal has been vacant.")
}

text AedesTrivis_Text_OrestesSageScene_Orestes2 {
	format("Well, if this tree vest is so important
			to the temple, why don't you go get it?")
}

text AedesTrivis_Text_OrestesSageScene_Sage2 {
	format("I'm bound by oathe to attend the Aedes
			Trivis. Only in death may I depart.
			Someone, perhaps you or your champion,
			must seek out the three pieces of Trivis
			broken by that scoundrel who came in green
			and robbed our sacred place of the Trivis.")
}

text AedesTrivis_Text_OrestesSageScene_Orestes3 {
	format("Despair! I know now there turly is no
			God, Gods, or Goddess looking down on me!
			My query on the bridge has been answered
			by the total absence of a reply.
			My mind's made up, I must now jump...now die.")
}

text AedesTrivis_Text_OrestesSageScene_Orestes4 {
	format("Who are you!? Why have you come to this place?
			I hope you did not come seeking guidance
			since that charlatan is offering none.
			He says some green pirate stole his tree vest
			so he can't tell anyone their future.")
}

text AedesTrivis_Text_OrestesSageScene_Orestes5 {
	format("I just realized you're the answer to my
			desperate supplication for help. The odds
			of another traveller arriving
			here just as I'm leaving...impossible!
			You must be here to restore the temple
			and bring the oracle back to tell me
			what is it I must do. I simply must
			speak with him soon or I will surely die!
			So please, hurry, find the missing tree vest
			and bring the oracle back. Maybe try
			to talk to that pretender and see if
			he has any helpful advice for you.
			Thank you God, Gods, Goddesses, or Goddess
			for answering my most desperate prayers!")
}

text AedesTrivis_Text_OrestesDuringTrivisQuest {
	format("Please help me! Please repair the tree vest and
			bring back the oracle, else I must die!")
}

text AedesTrivis_Text_SageIntroQuest {
    format("The thief in green snuck in during the night
			and stole the Trivis from this sacred place.
			That he wore green seems no coincidence
			for this was once the land of Hylia
			where young men were clothed in tunics of green
			when they reached the age of majority.
			Whether this thief was just a copycat,
			or if some of the Hylians survive
			underground, in the caves along the Drake,
			is not clear but I think the thief must have
			been inspired to take the Trivis by
			the Hylian people, living or dead.")
}

text AedesTrivis_Text_SageDuringQuest {
    format("If you intend to rescue the Trivis
			and return the temple's stolen glory
			I would begin your search inside the caves
			that run deep underground along the Drake.
			I know of one just south of the temple,
			along the western shore, not far from here.
			There are others as well. I am not sure
			if the thief has them or hid them or might
			be trying to use their power for ill.
			Tread carefully, good luck, and please return.")
}

//Trivis Complete Scene

//O: I told you I'm cursed I need to know what to do because as we wait my father is dishonored but it's my mother doing the defiling! I must know whether to act the anguish will lead me to death
text AedesTrivis_Text_Orestes_TrivisComplete1 {
	format("You don't understand! This is Urgent! I
			must have guidance! The guilt is killing me!")
}

//S: And I told you I am a mere custodian of this place. The speaker has gone and only the Trivis Returned could possibly bring him back
text AedesTrivis_Text_Sage_TrivisComplete1 {
	format("And as I told you, many times before,
			I am a mere custodian. I can't
			give you any advice worth more than words.
			Until the Trivis is returned, and the
			Speaker assumes his post, there is no one
			who can help you here and raising your voice
			will not change that. Now, please, compose yourself.")
}

text AedesTrivis_Text_Orestes_TrivisComplete2 {
	format("What's that? It's {PLAYER}!")
}

text AedesTrivis_Text_Sage_TrivisComplete2 {
	format("Have you found the Trivis?")
}

text AedesTrivis_Text_TrivisGlow {
	format("The three pieces of Trivis begin to glow.")
}

text AedesTrivis_Text_Orestes_TrivisComplete3 {
	format("What happened? Woah! What was that sound? That light?")
}

text AedesTrivis_Text_Sage_TrivisComplete3 {
	format("What happy day! You've done it lad! You have
			returned our temple to it's lost glory!
			The Trivis, at long last, has been restored!")
}

text AedesTrivis_Text_Orestes_TrivisComplete4 {
	format("The tree vest restored? That means...")
}

text AedesTrivis_Text_Slowking_TrivisComplete1 {
	format("Thank you, {PLAYER}.")
}

text AedesTrivis_Text_Orestes_TrivisComplete5 {
	format("What? Who was that?")
}

text AedesTrivis_Text_Sage_TrivisComplete4 {
	format("The speaker has returned!")
}

text AedesTrivis_Text_Slowking_TrivisComplete2 {
	format("The speaker? Yes, that's what they once called us.
			After the Trivis was stolen from here
			we were unable to take corporal
			form but, now that the temple is restored,
			we have returned to serve devout pilgrims.")
}

text AedesTrivis_Text_Orestes_TrivisComplete6 {
	format("Hello!")
}

text AedesTrivis_Text_Orestes_TrivisComplete7 {
	format("I'm Orestes, son of Agamemnon,
			and I desperately need divine advice!")
}

text AedesTrivis_Text_Slowking_TrivisComplete3 {
	format("Hasty Orestes, long have we observed
			your haughty family act beyond the will
			of He who holds the scale to judge our lives.
			Despite the godless actions of your kin,
			your own abstainment  from ritual prayer
			up to this point, and your rude impatience,
			we welcome and invite you to approach
			our platform and tell us what bothers you.")
}

text AedesTrivis_Text_Orestes_TrivisComplete8 {
	format("My father, who's soul may be stained with sin,
			lies petrified in bed, bewitched by my
			mother, who's own life is no more righteous.
			The shame of knowing my father lies there
			disgraced and cursed while I do nothing to
			avenge or rescue him from that sad fate
			fills me with deep remorse and thoughts of death.
			Yet neither can I act upon these pains
			without crossing mother, another sin.
			You say my family's sinful, and that I
			have ever scored the will of the divine.
			These things are true, but now I want to change.
			I came here to ask what action to take,
			to learn, then do, the will of the divine.
			I'm sorry if I seem hasty, or base,
			but my situation's indeed dire!")
}

//Hear ya, your father is wrongly dishonored and something must be done to save him. Your mother must be punished and defeated but yea you cannot be the one to do it. Find someone to do your dirty work for you, orchestrate the revival of your father and the downfall of your mother but you cannot be the hand of her downfall. That is the will of the divine as I see it.
text AedesTrivis_Text_Slowking_TrivisComplete4 {
	format("Your father has unjustly been abused
			and as his son you must see justice done.
			Since the offending party's your mother
			the hand of justice cannot be your own.
			You must find someone else to break the spell
			and free Agamemnon. Orestes, know
			your mother will not persist in this world.
			After her curse is broken she will die,
			but you will not be guilty for her death
			instead renowned as your father's savior.
			Therefore depart, find someone else to bring
			justice to your father, death to your mom.")
}

//But...
text AedesTrivis_Text_Orestes_TrivisComplete9 {
	format("But, how...")
}

//Enought I have spoken be gone
text AedesTrivis_Text_Slowking_TrivisComplete5 {
	format("No buts! We've said our prophecy.
			Be gone! Attend to your urgent business.")
}

//Nor approach player
text AedesTrivis_Text_Slowking_TrivisComplete6 {
	format("Now, {PLAYER}, approach our dais. We would thank
			you for your great service to our temple.")
}

//You have done great deed take this gift
text AedesTrivis_Text_Slowking_TrivisComplete7 {
	format("Most valiant and pure hearted {PLAYER}, we thank
			you for returning the stolen Trivis
			and restoring this place of light. Accept
			this gift on behalf of our diocese")
}

//that rock, use well, return sometime
text AedesTrivis_Text_Slowking_TrivisComplete8 {
	format("That ancient stone was once regalia
			of the Hylian Kings. It has been kept
			in our possession all this tired age.
			Now it is yours, to do with as you please.
			Use it wisely. Keep to the righteous path
			and by persistence you'll achieve your quest.
			Now farewell, {PLAYER}. Be about your business.")
}

text AedesTrivis_Text_Slowking_Return {
	format("If during your journey you require
			additional advice, return to us.")
}
